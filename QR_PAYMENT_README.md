# üèãÔ∏è‚Äç‚ôÇÔ∏è Fitness Management System with QR Payment

‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡∏ú‡πà‡∏≤‡∏ô QR Code ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ AppzStory Studio API

## üöÄ Features

### üí≥ ‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
- **QR Payment Integration**: ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö AppzStory Studio API
- **Real-time Payment Status**: ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö real-time
- **Webhook Support**: ‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏à‡∏≤‡∏Å payment gateway
- **Security**: ‡∏°‡∏µ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö signature ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢

### üéØ ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
- **Membership Plans**: ‡∏£‡∏≤‡∏¢‡∏ß‡∏±‡∏ô, ‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô, ‡∏£‡∏≤‡∏¢‡∏õ‡∏µ
- **Date Selection**: ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
- **Auto Calculate**: ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- **Status Tracking**: ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡πÅ‡∏ö‡∏ö real-time

### üèÉ‚Äç‚ôÄÔ∏è ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°
- **Class Management**: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡∏•‡∏≤‡∏™‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢
- **Equipment Booking**: ‡∏à‡∏≠‡∏á‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡¶£‡πå‡∏≠‡∏≠‡∏Å‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Å‡∏≤‡∏¢
- **Activity Tracking**: ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°‡∏Ç‡∏≠‡∏á‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å

### üë• ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ Admin
- **Member Management**: ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
- **Payment Reports**: ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
- **Analytics Dashboard**: ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥

## üõ†Ô∏è ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ

- **Frontend**: React.js, CSS3, React Router
- **Backend**: Supabase (PostgreSQL + Auth + Storage)
- **Payment Gateway**: AppzStory Studio API
- **Webhook Server**: Express.js, Node.js
- **Styling**: Custom CSS with Glass Morphism Design

## üì¶ ‡∏Å‡∏≤‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á

### 1. Clone Repository
```bash
git clone <repository-url>
cd fitness-supabase
```

### 2. ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á Dependencies
```bash
npm install
```

### 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Environment Variables
‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå `.env` ‡∏à‡∏≤‡∏Å `.env.example`:
```bash
cp .env.example .env
```

‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå `.env`:
```bash
# Supabase Configuration
REACT_APP_SUPABASE_URL=your_supabase_url_here
REACT_APP_SUPABASE_ANON_KEY=your_supabase_anon_key_here

# AppzStory Studio API
REACT_APP_APPZSTORY_API_KEY=your_api_key_here
REACT_APP_APPZSTORY_SECRET_KEY=your_secret_key_here
REACT_APP_APPZSTORY_MERCHANT_ID=your_merchant_id_here

# Webhook Server
APPZSTORY_SECRET_KEY=your_secret_key_here
PORT=3001
```

### 4. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Database
‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á SQL ‡∏ï‡πà‡∏≠‡πÑ‡∏õ‡∏ô‡∏µ‡πâ‡πÉ‡∏ô Supabase:
```sql
-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á qr_payments
\i create_qr_payments_table.sql

-- ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á memberships
\i create_memberships_table.sql

-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏£‡∏≤‡∏Ñ‡∏≤‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å
\i add_membership_columns.sql
```

## üöÄ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### 1. ‡πÄ‡∏£‡∏¥‡πà‡∏° React App
```bash
npm start
# ‡∏´‡∏£‡∏∑‡∏≠
npm run dev
```

### 2. ‡πÄ‡∏£‡∏¥‡πà‡∏° Webhook Server
```bash
# Terminal ‡πÅ‡∏¢‡∏Å
npm run webhook

# ‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ batch file (Windows)
start-webhook.bat
```

### 3. ‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå
- Frontend: `http://localhost:3000`
- Webhook Health Check: `http://localhost:3001/health`

## üîÑ Workflow ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô

### 1. User ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à
```
HomePage ‚Üí FitnessDetailPage ‚Üí FitnessDetailModal
```

### 2. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô
```
PaymentPage ‚Üí ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å QR Payment ‚Üí QRPayment Component
```

### 3. ‡∏™‡∏£‡πâ‡∏≤‡∏á QR Code
```javascript
// qrPaymentAPI.js
const qrData = await generatePaymentQR({
  amount: 299,
  description: "Fitness Membership",
  transaction_id: "TXN_123"
});
```

### 4. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
```javascript
// Auto-check ‡∏ó‡∏∏‡∏Å 3 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
const status = await checkQRPaymentStatus(transaction_id);
```

### 5. Webhook Notification
```javascript
// webhook-server.js
app.post('/webhook/appzstory', async (req, res) => {
  const { payment_id, status, reference_id } = req.body;
  // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
});
```

## üìä Database Schema

### qr_payments
```sql
CREATE TABLE qr_payments (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  transaction_id TEXT UNIQUE NOT NULL,
  amount DECIMAL(10,2) NOT NULL,
  status TEXT DEFAULT 'pending',
  qr_code_url TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  paid_at TIMESTAMP,
  gateway_response JSONB
);
```

### tbl_memberships
```sql
CREATE TABLE tbl_memberships (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  user_id UUID REFERENCES auth.users(id),
  fitness_id UUID REFERENCES tbl_fitness(id),
  membership_type TEXT, -- 'daily', 'monthly', 'yearly'
  start_date DATE,
  end_date DATE,
  amount DECIMAL(10,2),
  transaction_id TEXT,
  status TEXT DEFAULT 'pending'
);
```

## üîê Security Features

### 1. Signature Verification
```javascript
const verifySignature = (data, signature) => {
  const secretKey = process.env.APPZSTORY_SECRET_KEY;
  const expectedSignature = crypto
    .createHash('sha256')
    .update(data + secretKey)
    .digest('hex');
  return expectedSignature === signature;
};
```

### 2. RLS Policies
```sql
-- User ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏π‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
CREATE POLICY "Users can view own payments" 
ON qr_payments FOR SELECT 
USING (auth.uid() = user_id);
```

## üß™ ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö

### 1. Unit Tests
```bash
npm test
```

### 2. Mock Webhook
```bash
curl -X POST http://localhost:3001/webhook/appzstory \
  -H "Content-Type: application/json" \
  -d '{"payment_id": "test", "status": "success"}'
```

### 3. QR Payment Flow
1. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏û‡πá‡∏Ñ‡πÄ‡∏Å‡∏à‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Fitness Detail
2. ‡∏Ñ‡∏•‡∏¥‡∏Å "‡∏à‡∏≠‡∏á‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£" 
3. ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å "QR Payment"
4. ‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡∏î‡πâ‡∏ß‡∏¢‡πÅ‡∏≠‡∏õ‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£
5. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞

## üì± UI/UX Features

### Glass Morphism Design
```css
.glass-card {
  background: rgba(255, 255, 255, 0.15);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 15px;
}
```

### Responsive Design
- ‚úÖ Mobile First
- ‚úÖ Tablet Optimized  
- ‚úÖ Desktop Responsive

### Real-time Updates
- ‚úÖ Payment Status
- ‚úÖ Countdown Timer
- ‚úÖ Auto Refresh

## üö® Troubleshooting

### QR Code ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API Key ‡πÉ‡∏ô `.env`
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö network connection
3. ‡∏î‡∏π console errors

### Webhook ‡πÑ‡∏°‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö webhook server: `http://localhost:3001/health`
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö AppzStory Dashboard
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö signature verification

### Database Error
1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Supabase connection
2. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö RLS policies
3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö table permissions

## üìö ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

- [Webhook Setup Guide](WEBHOOK_GUIDE.md)
- [Testing Guide](TESTING_GUIDE.md)
- [Admin System Guide](ADMIN_SYSTEM.md)
- [RLS Setup Guide](RLS_SETUP_GUIDE.md)

## üéØ Roadmap

- [ ] Push Notifications
- [ ] Multi-language Support
- [ ] Advanced Analytics
- [ ] Mobile App Integration
- [ ] Loyalty Points System
- [ ] Social Features

## üë• Contributing

1. Fork the project
2. Create feature branch (`git checkout -b feature/AmazingFeature`)
3. Commit changes (`git commit -m 'Add AmazingFeature'`)
4. Push to branch (`git push origin feature/AmazingFeature`)
5. Open Pull Request

## üìÑ License

This project is licensed under the MIT License.

## üìû Support

‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠:
- Email: support@example.com
- Line: @fitness-support
- Phone: 02-xxx-xxxx